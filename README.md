Предсказание цены автомобилей  

1. EDA
   
1.1. Первичный анализ 

Датасет содержит 19 237 записей и 18 признаков, описывающих характеристики автомобилей, включая числовые и категориальные данные. После удаления 313 дубликатов осталось 18 924 уникальные записи. 

Некоторые признаки требовали предобработки: 

В колонке Levy встречались пропуски, обозначенные символом -. Они были заменены на 0 и преобразованы в числовой тип. 

Признак Mileage содержал строки вида "186005 km", которые были очищены и приведены к целым числам. 

Признак ID удалён как неинформативный для предсказания. 

Проверка на отрицательные значения для Price, Airbags, Cylinders показала их отсутствие. 

1.2. Преобразование признаков 

Doors содержал значения вроде 04-May, 02-Mar, >5; с помощью пользовательской функции все значения переведены в числовой формат (2, 4, 6 дверей). 

Из признака Engine volume выделены два новых признака для корректной обработки: 

engine_volume — числовой объём двигателя 

is_turbo — бинарный индикатор турбонаддува 

Leather interior преобразован из категориального (Yes/No) в бинарный (1/0). 

 

1.3. Распределение признаков и корреляционный анализ 

Числовые признаки (Price, Levy, Mileage, Prod. year, Cylinders, Airbags) имеют асимметричное распределение с длинными хвостами. 

Среди категориальных переменных наибольшее количество уникальных значений имеет Model (~1590), что указывает на высокую дисперсию внутри класса. 

Большинство автомобилей имеют левый руль (≈92%), топливо Petrol (≈52%), тип кузова Jeep или Sedan. 

Для смешанных типов данных использовалась метрика Phik, учитывающая числовые и категориальные признаки. Наиболее коррелирующий с другими признак — Model. 

 

1.4. Подготовка данных к моделированию 

Целевая переменная Price не трансформировалась на этом этапе. 

Категориальные признаки кодировались: 

Target Encoding для признаков с большим числом категорий (Manufacturer, Model, Color) 

One-Hot Encoding для признаков с ограниченным числом категорий (Category, Fuel type, Gear box type, Drive wheels, Wheel) 

Все преобразования собраны в Pipeline с использованием ColumnTransformer для корректного разделения обучения и валидации. 

 

2. Baseline моделей 

2.1. Цель 

Построение базовых моделей для предсказания цены автомобиля на исходных признаках, чтобы определить минимальный уровень качества и выявить проблемные моменты. 

 

2.2. Используемые модели 

Модель 

Основные параметры 

Linear Regression 
по умолчанию 

Random Forest Regressor 
n_estimators=100, random_state=42 

 

Gradient Boosting Regressor 
random_state=42 

 

2.3. Результаты baseline 

Модель             MAE ↓        MSE ↓       R² ↑ 

Linear Regression 13 139     5.42×10⁸       -0.57 

Random Forest Regressor 
5 776 
2.99×10⁹ 
-7.63 

Gradient Boosting Regressor 
13 895 
3.70×10¹⁰ 
-106.05 

Вывод: отрицательные значения R² показывают, что модели не уловили структуру зависимостей между признаками и ценой на исходных данных, плохие показатели по всем метрикам 

 

3. Feature Engineering и тюнинг гиперпараметров 

3.1. Генерация новых признаков 

car_age — возраст автомобиля (2025 − год производства) 

mileage_per_year — средний пробег автомобиля в год 

Mileage_log — логарифмированный пробег 

Levy_log - логарифмированный налог 

Эти признаки улучшили информативность и позволили моделям лучше захватывать зависимость цены от возраста и технических характеристик. 

3.2. Предобработка и трансформация признаков 

Фильтрация выбросов по 99-му перцентилю для Price и других числовых признаков. 

Логарифмирование (np.log1p) целевой переменной для стабилизации обучения. 

Стандартизация числовых признаков (StandardScaler). 

Категориальные признаки: пропущенные значения заменены на наиболее частые, One-Hot кодирование с handle_unknown="ignore". 

3.3. Обучение моделей и кросс-валидация 

Использовались модели: 

LinearRegression 

RandomForestRegressor 

GradientBoostingRegressor 

Метрики: MAE, MSE, RMSE, R², MAPE, SMAPE. 

Ключевая метрика на которую больше ориентировался MAE 

Результаты после лог-трансформации и добавления новых признаков, и 99 перцентиля : 

Модель 

MAE 
MSE 
RMSE 
R² 
MAPE 
SMAPE 

RandomForest 
4,274 
63,026,002 
7,939 
0.78 
622.95% 
37.70% 

GradientBoosting 
6,568 
118,866,438 
10,903 
0.450 
672.81% 
59.52% 

LinearRegression 
8,462 
172,692,720 
13,141 
0.200 
757.11% 
71.82% 

 

 

3.4. Подбор гиперпараметров 

RandomForestRegressor: 

n_estimators = [100, 200, 500] 

max_depth = [None,10, 20, 30] 

min_samples_split = [2, 5, 10] 

Лучшие гиперпараметры: {'model__regressor__max_depth': 30, 'model__regressor__min_samples_split': 2, 'model__regressor__n_estimators': 500} 

MAE на кросс-валидации: 4,255 

3.5. Итоговые выводы 

Наиболее точная модель — RandomForestRegressor с лог-трансформированным таргетом и оптимальными гиперпараметрами. 

Генерация новых признаков (car_age, mileage_per_year, Mileage_logб Levy_log) немного улучшила качество модели. 

Логарифмирование целевой переменной стабилизировало обучение и снизило влияние экстремальных значений. 

 

 
